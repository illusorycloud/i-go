<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>代码部署sdk - 文档中心 - 手势验证码（VAPTCHA）</title>
    <meta name="keywords" content="VAPTCHA部署,sdk,VAPTCHA开发文档,VAPTCHA后端部署,VAPTCHA前端部署">
    <meta name="description" content="VAPTCHA开发文档页，目前支持java,python,php,.net,nodejs等开发语言。">
    <link rel="stylesheet" type="text/css" href="https://static.vaptcha.com/assets/css/document/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="https://static.vaptcha.com/assets/css/public/common.css" />
    <link rel="stylesheet" type="text/css" href="../../assets/css/public/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://static.vaptcha.com/assets/v2/css/md.2.0.1.css" />
    <link rel="stylesheet" type="text/css" href="https://static.vaptcha.com/assets/v2/css/document.2.0.1.css" />
    <!-- <link rel="stylesheet" type="text/css" href="../../static-pages/css/md.css" />  -->
    <!-- <link rel="stylesheet" type="text/css" href="../../static-pages/css/document.css" /> -->
    <script src="https://static.vaptcha.com/assets/js/jquery.min.js"></script>
    <script src="https://static.vaptcha.com/assets/js/vaptcha-language.js"></script>
    <script src="https://static.vaptcha.com/assets/js/canvas-particle.js"></script>
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e3da96e182f65086e71c28cfdbb64b10";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
        (function(){
				var bp = document.createElement('script');
				var curProtocol = window.location.protocol.split(':')[0];
				if (curProtocol === 'https') {
					bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
				}
				else {
					bp.src = 'http://push.zhanzhang.baidu.com/push.js';
				}
				var s = document.getElementsByTagName("script")[0];
				s.parentNode.insertBefore(bp, s);
			})();
    </script>
</head>
<body>
    <div id="canvas-cont"></div>
    <div class="vaptcha">
        <div class="nav">
            <a class="nav-logo" title="VAPTCHA" href="/">
                <img alt="VAPTCHA" src="https://static.vaptcha.com/assets/img/index/logo.png"/>
            </a>
            <!-- <div  class="btn-group dropdown change-language">
                <a id='btn-down-lang' title="中文" class="btn btn-down" type="button">
                    <img alt="中文" src="https://static.vaptcha.com/assets/img/ch.png">
                </a>
            </div> -->
            <div class="nav-link">
                <a href="javascript:;" class="active">文档中心</a>
                
                <a href="/demo/index.html">在线体验</a>
                <a href="/login.html">登录后台</a>
				<a href="/register.html" class="get">免费注册</a>
            </div>
            <div class="canvas-cont">
                <h1>VAPTCHA文档中心</h1>
            </div>
            <div class="bar">
                <a href="/document/index.html">产品介绍</a>
					<a href="/document/install.html"  class="active" >代码部署</a>
					<a href="/document/plugin.html" style="display:none">插件</a>
					<a href="/document/faq.html" >FAQ</a>
					<a href="/document/sms.html" >V-SMS</a>
					<a href="/document/contract.html">服务协议</a>
            </div>
        </div>
        <div class="main-cont">
            <div class="main-left-cont">
                <div class="scroll">
                    <ul class="main-left">
                        <li>
                            <a href="#header-n2" id="verification" class="title"><i class="fa fa-list-alt"></i>验证流程</a>
                        </li>
                        <li>
                            <a href="#header-n21" id="smsweb"  class="title"><i class="fa fa-laptop"></i>Web端部署</a>
                        </li>
                        <ul class="main-left-one smsweb">
                            <li>
                                <a class="current"  href="#header-n25">环境</a>
                            </li>
                            <li>
                                <a href="#header-n28">安装</a>
                            </li>
                            <li>
                                <a href="#header-n71">配置参数</a>
                            </li>
                            <li>
                                <a href="#header-n165">验证码实例</a>
                            </li>
                            <li>
                                <a href="#header-n170">实例API方法</a>
                            </li>
                        </ul>
                        <li>
                            <a href="#header-n500" id="ios"  class="title"><i class="fa fa-server"></i>iOS SDK部署(beta)</a>
                        </li>
                        <ul class="main-left-one ios">
                            <li>
                                <a href="#header-n501">环境需求</a>
                            </li>
                            <li>
                                <a href="#header-n502">资源下载</a>
                            </li>
                            <li>
                                <a href="#header-n503">配置</a>
                            </li>
                            <li>
                                <a href="#header-n504">配置接口</a>
                            </li>
                            <li>
                                <a href="#header-n505">代码示例</a>
                            </li>
                        </ul>
                        <li>
                            <a href="#header-n600" id="android"  class="title"><i class="fa fa-server"></i>Android SDK部署(beta)</a>
                        </li>
                        <ul class="main-left-one android">
                            <li>
                                <a href="#header-n601">环境需求</a>
                            </li>
                            <li>
                                <a href="#header-n602">资源下载</a>
                            </li>
                            <li>
                                <a href="#header-n603">配置</a>
                            </li>
                            <li>
                                <a href="#header-n604">代码示例</a>
                            </li>
                        </ul>
                        <li >
                            <a href="#header-n221" id="smsonce"  class="title"><i class="fa fa-server"></i>服务端二次验证</a>
                        </li>
                        <ul class="main-left-one smsonce"> 
                            <li>
                                <a href="#header-n225">API请求数据</a>
                            </li>
                            <li>
                                <a href="#header-n247">API响应结果</a>
                            </li>
                        </ul>
                        <li >
                            <a href="#header-n0" id="downtime"  class="title"><i class="fa fa-server"></i>宕机模式</a>
                        </li>
                        <ul class="main-left-one downtime"> 
                            <li>
                                <a href="#header-n8">outage接口说明</a>
                            </li>
                            <li>
                                <a href="#header-n16">接口参数</a>
                            </li>
                            <li>
                                <a href="#header-n41">get 获取图片操作</a>
                            </li>
                            <li>
                                <a href="#header-n85">verify 轨迹验证操作</a>
                            </li>
                            <li>
                                <a href="#header-n117">服务器端验证token</a>
                            </li>
                            <li>
                                <a href="#header-n121">完整demo</a>
                            </li>
                        </ul>
                    </ul>
                </div>
            </div>
            <div class="main-right install-right">
                <div class="con">
                    <div class="code">
                        <div  id='write'  class = 'is-node'><h1><a name='header-n2' class='md-header-anchor code-item'></a>验证流程</h1><ol start='' ><li><p>创建验证单元，获取<code>VID</code>和<code>Key</code> ：<a target="_blank" href='https://www.vaptcha.com/manage'>点击创建</a>。</p></li><li><p>将<code>https://cdn.vaptcha.com/v2.js</code>引入到你的页面。</p></li><li><p>将VAPTCHA初始化到你需要的位置，具体web端部署请查看：<a href='#header-n21'>客户端部署</a>。</p></li><li><p>用户验证通过得到<code>token</code>，与表单数据一同提交到服务端。</p></li><li><p>服务端得到<code>token</code>后，向VAPTCHA服务器验证<code>token</code>的有效性，验证通过说明此次请求有效，服务端验证流程请查看：<a href='#header-n221'>服务端二次验证</a>。</p><p><br/></p></li></ol><h1><a name='header-n21' class='md-header-anchor code-item'></a>Web客户端部署</h1><blockquote><p>web客户端部署VAPTCHA所需的配置和接口说明文档</p></blockquote><h4><a name='header-n25' class='md-header-anchor code-item'></a>环境</h4><p>兼容性 IE8+(IE8及以上)、Chrome、Firefox、Safari、Opera、主流手机浏览器、iOS 及 Android上的内嵌Webview</p><h4><a name='header-n28' class='md-header-anchor code-item'></a>安装</h4><ol start='' ><li><p>准备工作：<a href='https://www.vaptcha.com/manage' target="_blank">创建验证单元</a>，获取验证单元id(初始化验证码的必填参数)。</p></li><li><p>引入前端sdk:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="html"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span> <span class="cm-attribute">src</span>=<span class="cm-string">"https://cdn.vaptcha.com/v2.js"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"></div><div class="CodeMirror-gutters" style="display: none; height: 30px;"></div></div></div></pre></li><li><p>初始化VAPTCHA</p><ul><li><p>方式一：使用初始化初始函数进行初始化，并调用验证示例加载验证按钮</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="html" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>&#8203;</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">id</span>=<span class="cm-string">"vaptchaContainer"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width: 300px;height: 36px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-init-main"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-init-loading"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"https://www.vaptcha.com"</span> <span class="cm-attribute">target</span>=<span class="cm-string">"_blank"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"https://cdn.vaptcha.com/vaptcha-loading.gif"</span> <span class="cm-tag cm-bracket">/&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-text"</span><span class="cm-tag cm-bracket">&gt;</span>Vaptcha启动中...<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span> <span class="cm-attribute">src</span>=<span class="cm-string">"https://cdn.vaptcha.com/v2.js"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">vaptcha</span>({</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">//配置参数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">vid</span>: <span class="cm-string">'****'</span>, <span class="cm-comment">// 验证单元id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">type</span>: <span class="cm-string">'click'</span>, <span class="cm-comment">// 展现类型 点击式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">container</span>: <span class="cm-string">'#vaptchaContainer'</span> <span class="cm-comment">// 按钮容器，可为Element 或者 selector</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-property">then</span>(<span class="cm-keyword">function</span> (<span class="cm-def">vaptchaObj</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">render</span>()<span class="cm-comment">// 调用验证实例 vaptchaObj 的 render 方法加载验证按钮</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 492px;"></div><div class="CodeMirror-gutters" style="display: none; height: 492px;"></div></div></div></pre></li><li><p>方式二：自动初始化并加载验证按钮</p><blockquote><p>如果你是以直接提交表单的方式发起请求，推荐使用此方法，容器内默认会添加一个<code>name</code>值为<code>vapthca_token</code>的<code>input</code>，其值为验证通过后的<code>token</code> 。</p></blockquote><p>可选以下两种方式</p><p>配置<code>data-vid</code>，填入验证单元的<code>VID</code>，此种方式默认初始化点击式</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="html"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">data-vid</span>=<span class="cm-string">"*******"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width: 300px;height: 36px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-init-main"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-init-loading"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"https://www.vaptcha.com"</span> <span class="cm-attribute">target</span>=<span class="cm-string">"_blank"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"https://cdn.vaptcha.com/vaptcha-loading.gif"</span> <span class="cm-tag cm-bracket">/&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-text"</span><span class="cm-tag cm-bracket">&gt;</span>Vaptcha启动中...<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 228px;"></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></pre><p>配置<code>data-config</code>，填入配置对象的<code>JSON</code>字符串</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="html"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">data-config</span>=<span class="cm-string">'{"vid": "*******","type": "click"}'</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width: 300px;height: 36px;"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre></li></ul></li><li><p>使用点击式时推荐使用官方预加载动画：</p><p>效果图：</p><p><img src='https://cdn.vaptcha.com/button-loading.gif' alt='' referrerPolicy='no-referrer' /></p><p>代码如下:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="html" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">style</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-qualifier">.vaptcha-init-main</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">display</span>: <span class="cm-atom">table</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">width</span>: <span class="cm-number">100%</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">height</span>: <span class="cm-number">100%</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">background-color</span>: <span class="cm-atom">#EEEEEE</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-qualifier">.vaptcha-init-loading</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">display</span>: <span class="cm-atom">table-cell</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">vertical-align</span>: <span class="cm-atom">middle</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">text-align</span>: <span class="cm-atom">center</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-qualifier">.vaptcha-init-loading</span>&gt;<span class="cm-tag">a</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">display</span>: <span class="cm-atom">inline-block</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">width</span>: <span class="cm-number">18px</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">height</span>: <span class="cm-number">18px</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">border</span>: <span class="cm-atom">none</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-qualifier">.vaptcha-init-loading</span>&gt;<span class="cm-tag">a</span> <span class="cm-tag">img</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">vertical-align</span>: <span class="cm-atom">middle</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-qualifier">.vaptcha-init-loading</span> <span class="cm-qualifier">.vaptcha-text</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">font-family</span>: <span class="cm-atom">sans-serif</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">font-size</span>: <span class="cm-number">12px</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">color</span>: <span class="cm-atom">#CCCCCC</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">vertical-align</span>: <span class="cm-atom">middle</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">style</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">&lt;!-- 点击式按钮建议高度介于36px与46px  --&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">&lt;!-- 嵌入式仅需设置宽度，高度根据宽度自适应，最小宽度为200px --&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-container"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width:300px;height:36px;"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">&lt;!--vaptcha-container是用来引入VAPTCHA的容器，下面代码为预加载动画，仅供参考--&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-init-main"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-init-loading"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"https://www.vaptcha.com"</span> <span class="cm-attribute">target</span>=<span class="cm-string">"_blank"</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">"https://cdn.vaptcha.com/vaptcha-loading.gif"</span> <span class="cm-tag cm-bracket">/&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">class</span>=<span class="cm-string">"vaptcha-text"</span><span class="cm-tag cm-bracket">&gt;</span>VAPTCHA启动中...<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 976px;"></div><div class="CodeMirror-gutters" style="display: none; height: 976px;"></div></div></div></pre><p>&nbsp;</p></li></ol><h4><a name='header-n71' class='md-header-anchor code-item'></a>配置参数</h4><blockquote><p>初始化验证码所需要的配置参数，vaptcha初始化函数的第一参数。隐藏式仅限VIP使用</p></blockquote><h5><a name='header-n75' class='md-header-anchor '></a>通用参数</h5><p>必填参数</p><figure><table><thead><tr><th style='text-align:left;' >参数名</th><th style='text-align:left;' >类型</th><th style='text-align:left;' >说明</th></tr></thead><tbody><tr><td style='text-align:left;' >vid</td><td style='text-align:left;' >字符串</td><td style='text-align:left;' >验证单元的<code>VID</code></td></tr><tr><td style='text-align:left;' >type</td><td style='text-align:left;' >字符串</td><td style='text-align:left;' >可选值<code>click</code>, <code>embed</code>, <code>invisible</code></td></tr></tbody></table></figure><p>可选参数</p><figure><table><thead><tr><th style='text-align:left;' >参数名</th><th style='text-align:left;' >类型</th><th style='text-align:left;' >默认值</th><th style='text-align:left;' >说明</th></tr></thead><tbody><tr><td style='text-align:left;' >lang</td><td style='text-align:left;' >字符串</td><td style='text-align:left;' ><code>zh-CN</code></td><td style='text-align:left;' >可选值<code>zh-CN</code>,<code>en</code>,<code>zh-TW</code></td></tr><tr><td style='text-align:left;' >https</td><td style='text-align:left;' >布尔值</td><td style='text-align:left;' ><code>false</code></td><td style='text-align:left;' >协议类型，是否为https</td></tr><tr><td style='text-align:left;' >scene</td><td style='text-align:left;' >字符串</td><td style='text-align:left;' ><code>空字符串</code></td><td style='text-align:left;' >验证单元场景</td></tr></tbody></table></figure><p><code>type</code>参数说明</p><p>此参数决定了验证码的类型，不一样的类型也有不同的参数，对应的效果如下</p><ul><li><code>click</code>，点击式，demo预览地址: <a href='https://www.vaptcha.com/demo/popup' target='_blank' class='url'>https://www.vaptcha.com/demo/popup</a></li><li><code>embed</code>，嵌入式，demo预览地址: <a href='https://www.vaptcha.com/demo/embed' target='_blank' class='url'>https://www.vaptcha.com/demo/embed</a></li><li><code>invisible</code>，隐藏式，demo预览地址: <a href='https://www.vaptcha.com/demo/invisible' target='_blank' class='url'>https://www.vaptcha.com/demo/invisible</a></li></ul><h5><a name='header-n128' class='md-header-anchor '></a>类型参数</h5><figure><table><thead><tr><th style='text-align:left;' >适用类型</th><th style='text-align:left;' >参数名</th><th style='text-align:left;' >参数类型</th><th style='text-align:left;' >必填</th><th style='text-align:left;' >默认值</th><th style='text-align:left;' >说明</th></tr></thead><tbody><tr><td style='text-align:left;' >点击式、嵌入式</td><td style='text-align:left;' >container</td><td style='text-align:left;' ><code>Element</code></td><td style='text-align:left;' ><code>selector</code></td><td style='text-align:left;' >是</td><td style='text-align:left;' >无</td></tr><tr><td style='text-align:left;' >点击式</td><td style='text-align:left;' >style</td><td style='text-align:left;' >字符串</td><td style='text-align:left;' >否</td><td style='text-align:left;' ><code>dark</code></td><td style='text-align:left;' >按钮样式，可选<code>dark</code>,<code>light</code></td></tr><tr><td style='text-align:left;' >点击式</td><td style='text-align:left;' >color</td><td style='text-align:left;' >字符串</td><td style='text-align:left;' >否</td><td style='text-align:left;' ><code>#57ABFF</code></td><td style='text-align:left;' >按钮颜色</td></tr><tr><td style='text-align:left;' >隐藏式</td><td style='text-align:left;' >aiAnimation</td><td style='text-align:left;' >布尔值</td><td style='text-align:left;' >否</td><td style='text-align:left;' >true</td><td style='text-align:left;' >是否显示验证动画</td></tr></tbody></table></figure><h4><a name='header-n165' class='md-header-anchor code-item'></a>验证码实例</h4><h5><a name='header-n166' class='md-header-anchor '></a>获取实例</h5><p>调用<code>vaptcha</code>方法，第一个参数传入配置，返回一个对象，该对象提供一个<code>then</code>方法，接受一个回调函数，返回创建成功后的vaptcha实例对象<code>vaptchaObj</code></p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">vaptcha</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">vid</span>: <span class="cm-string">'****'</span>, <span class="cm-comment">// 验证单元id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">type</span>: <span class="cm-string">'click'</span>, <span class="cm-comment">// 显示类型 点击式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">container</span>: <span class="cm-string">'#vaptchaContainer'</span> <span class="cm-comment">// 按钮容器，可为Element 或者 selector</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-property">then</span>(<span class="cm-keyword">function</span> (<span class="cm-def">vaptchaObj</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">render</span>()<span class="cm-comment">// 调用验证实例 vpObj 的 render 方法加载验证按钮</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 162px;"></div><div class="CodeMirror-gutters" style="display: none; height: 162px;"></div></div></div></pre><h4><a name='header-n170' class='md-header-anchor code-item'></a>实例API方法</h4><h5><a name='header-n171' class='md-header-anchor '></a><code>render</code></h5><p>仅供点击式和嵌入式使用。执行初始化操作，将按钮或者图片插入到配置参数中的容器中去。示例代码如下:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">window</span>.<span class="cm-property">vaptcha</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">//配置参数省略</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-property">then</span>(<span class="cm-keyword">function</span>(<span class="cm-def">vaptchaObj</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">render</span>();<span class="cm-comment">//执行该方法, 生成验证码</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 118px;"></div><div class="CodeMirror-gutters" style="display: none; height: 118px;"></div></div></div></pre><h5><a name='header-n175' class='md-header-anchor '></a><code>listen</code></h5><p>用于监听验证事件。支持的事件如下:</p><ul><li><p><code>pass</code> 事件，验证通过时触发</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">window</span>.<span class="cm-property">vaptcha</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">//配置参数省略</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-property">then</span>(<span class="cm-keyword">function</span>(<span class="cm-def">vaptchaObj</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">listen</span>(<span class="cm-string">'pass'</span>, <span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">// 验证成功， 进行登录操作</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">render</span>();<span class="cm-comment">//执行该方法, 生成验证码</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre></li><li><p><code>close</code> 事件，关闭验证弹窗时触发</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">window</span>.<span class="cm-property">vaptcha</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">//配置参数省略</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-property">then</span>(<span class="cm-keyword">function</span>(<span class="cm-def">vaptchaObj</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">listen</span>(<span class="cm-string">'close'</span>, <span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">//验证弹窗关闭触发</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">render</span>();<span class="cm-comment">//执行该方法, 生成验证码</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre></li></ul><h5><a name='header-n187' class='md-header-anchor '></a><code>validate</code></h5><p>仅供隐藏式使用。由开发者决定何时调用该方法进行验证，比如在表单提交时调用该方法。</p><p>使用方式: <code>VAPTCHA</code>实例初始化完成后，等到用户点击登录按钮时执行<code>validate()</code>方法，执行验证，验证成功后，触发验证通过事件</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">window</span>.<span class="cm-property">vaptcha</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-property">vid</span>: <span class="cm-string">'*******'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-property">type</span>: <span class="cm-string">'invisible'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">//其他配置参数省略</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-property">then</span>(<span class="cm-keyword">function</span>(<span class="cm-def">vaptchaObj</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">obj</span> <span class="cm-operator">=</span> <span class="cm-variable-2">vaptchaObj</span>;<span class="cm-comment">//将VAPTCHA验证实例保存到局部变量中</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 验证码加载完成后将事件绑定到按钮</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// 调用</span><span class="cm-comment cm-overlay cm-search-hit">validate</span><span class="cm-comment">()方法的伪代码，将该方法的调用绑定在'click'事件上，实际开发中需要更改为合适的调用方式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">listen</span>(<span class="cm-string">'pass'</span>, <span class="cm-keyword">function</span>() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-comment">// 验证成功进行后续操作</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">var</span> <span class="cm-def">data</span> <span class="cm-operator">=</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-comment">//表单数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-property">token</span>: <span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">getToken</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">$</span>.<span class="cm-property">post</span>(<span class="cm-string">'/login'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">$</span>(<span class="cm-string">'#login-button'</span>).<span class="cm-property">on</span>(<span class="cm-string">'click'</span>,<span class="cm-keyword">function</span>(){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property cm-overlay cm-search-hit">validate</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">$</span>(<span class="cm-string">'#reset'</span>).<span class="cm-property">on</span>(<span class="cm-string">'click'</span>,<span class="cm-keyword">function</span>(){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">reset</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 514px;"></div><div class="CodeMirror-gutters" style="display: none; height: 514px;"></div></div></div></pre><h5><a name='header-n193' class='md-header-anchor '></a><code>getToken</code></h5><blockquote><p><code>token</code>的有效期为3分钟，验证通过后3分钟此接口返回空。建议用户根据<code>token</code>是否为空来判断验证码是否通过验证。</p></blockquote><p>所有模式均可用，推荐使用此接口来获取验证结果。用于获取验证结果, 返回<code>token</code>，由于token只可使用一次，所以调用<code>getResult</code>接口获取<code>token</code>后，<code>token</code>将被置空。</p><p>推荐的用法:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">data</span> <span class="cm-operator">=</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">username</span>: <span class="cm-string">''</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">password</span>: <span class="cm-string">''</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">token</span>: <span class="cm-variable">vaptchaObj</span>.<span class="cm-property">getToken</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">};</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-variable">data</span>.<span class="cm-property">token</span> <span class="cm-operator">===</span> <span class="cm-string">''</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">alert</span>(<span class="cm-string">'请进行人机验证'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">} <span class="cm-keyword">else</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">$</span>.<span class="cm-property">post</span>(<span class="cm-string">'login'</span>, <span class="cm-variable">data</span>, <span class="cm-keyword">function</span>(<span class="cm-def">r</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  })</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 294px;"></div><div class="CodeMirror-gutters" style="display: none; height: 294px;"></div></div></div></pre><h5><a name='header-n202' class='md-header-anchor '></a><code>renderTokenInput</code></h5><blockquote><p>如果你是以直接提交表单的方式发起请求，推荐使用此函数向表单添加token值</p></blockquote><p>此函数用于向表单添加一个名为<code>vaptcha_token</code>的<code>input</code>标签，如下</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="html"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">name</span>=<span class="cm-string">"vaptcha_token"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"************"</span> <span class="cm-tag cm-bracket">/&gt;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"></div><div class="CodeMirror-gutters" style="display: none; height: 30px;"></div></div></div></pre><p>函数有一个参，数默认值为参数配置中的<code>container</code>容器，使用隐藏式时为必填，<code>input</code>将添加到配置的容器中，参数类型为<code>selector</code>或者<code>Element</code>。</p><p>示例代码：</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">window</span>.<span class="cm-property">vaptcha</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">//配置参数省略</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-property">then</span>(<span class="cm-keyword">function</span>(<span class="cm-def">vaptchaObj</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">renderTokenInput</span>(<span class="cm-string">'.login-form'</span>)<span class="cm-comment">//向表单中添加input标签</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">vaptchaObj</span>.<span class="cm-property">render</span>();<span class="cm-comment">//执行该方法, 生成验证码</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 140px;"></div><div class="CodeMirror-gutters" style="display: none; height: 140px;"></div></div></div></pre><h5><a name='header-n214' class='md-header-anchor '></a><code>reset</code></h5><p> 所有模式均可用。验证码重置操作，例如可在登录失败时调用。</p><p>示例代码：</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">$</span>.<span class="cm-property">post</span>(<span class="cm-string">'login'</span>,<span class="cm-variable">data</span>, <span class="cm-keyword">function</span>(<span class="cm-def">r</span>) {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span>(<span class="cm-variable-2">r</span>.<span class="cm-property">code</span> <span class="cm-operator">!==</span> <span class="cm-number">200</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">'登录失败'</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">_obj</span>.<span class="cm-property">reset</span>(); <span class="cm-comment">//重置验证码</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 140px;"></div><div class="CodeMirror-gutters" style="display: none; height: 140px;"></div></div></div></pre><p>&nbsp;</p><div id="write" class="is-node"><h1><a name="header-n500" class="md-header-anchor "></a>VAPTCHA-iOS SDK部署</h1><blockquote><p>VAPTCHA-iOS SDK提供给集成iOS原生客户端开发的开发者使用，SDK不依赖任何第三方库。</p></blockquote><h4><a name="header-n501" class="md-header-anchor code-item"></a>环境需求</h4><figure><table><thead><tr><th>条目</th><th>资源</th></tr></thead><tbody><tr><td>开发目标</td><td>iOS9+</td></tr><tr><td>开发环境</td><td>Xcode 10.0</td></tr><tr><td>demo依赖</td><td><code>UIKit.framework,Foundation.framework</code></td></tr></tbody></table></figure><h4><a name="header-n502" class="md-header-anchor code-item"></a>资源下载</h4><figure><table><thead><tr><th>条目</th><th>资源地址</th></tr></thead><tbody><tr><td>SDK下载链接</td><td><a href="https://github.com/VAPTCHA/VAPTCHA-iOS.git">地址</a></td></tr><tr><td>SDK接口文档</td><td>查看头文件注释</td></tr><tr><td>Demo工程下载</td><td><a href="https://github.com/VAPTCHA/VAPTCHA-iOS">地址</a></td></tr></tbody></table></figure><h4><a name="header-n503" class="md-header-anchor code-item"></a>配置</h4><h5><a name="header-n34" class="md-header-anchor "></a>1.获取SDK</h5><p>使用git命令从Github获取：</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">git clone https://github.com/VAPTCHA/VAPTCHA-iOS.git</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"></div><div class="CodeMirror-gutters" style="display: none; height: 30px;"></div></div></div></pre><p>手动下载获取：<a href="https://github.com/VAPTCHA/VAPTCHA-iOS">Github: vaptcha iOS</a></p><h5><a name="header-n41" class="md-header-anchor "></a>2.导入SDK</h5><p>1.从Github上获取的SDK手动添加，将下载获取的<code>Vaptcha.framework</code>文件拖拽到工程中，确保<code>Copy  items if needed</code>已经被勾选。</p><p><img src="https://static.vaptcha.com/assets/img/document-ios1.png" alt="" referrerpolicy="no-referrer"></p><p>请使用<code>Linked  Frameworks and Libraries</code>方式导入framework。在拖入<code>Vaptcha.framework</code>到工程时后, 还要检查<code>.framework</code>是否被添加到<code>PROJECT  -&gt; Build Phases -&gt; Linked Frameworks and Libraries</code>。</p><p><img src="https://static.vaptcha.com/assets/img/document-ios2.png" alt="" referrerpolicy="no-referrer"></p><p>2.针对静态库中的<code>Category</code>,  需要在对应target的<code>Build  Settings-&gt;Other  Linker Flags</code>添加<code>-all_load</code>编译选项。建议先添加<code>-ObjC</code>，如果依然有问题，再添加<code>-all_load</code>。</p><p><img src="https://static.vaptcha.com/assets/img/document-ios3.png" alt="" referrerpolicy="no-referrer"></p><p>3.在拖入<code>Vaptcha.framework</code>的同时，需要将仓库中的资源文件<code>VPResource.bundle</code>同时拖入到项目中，这里以 bundle 外嵌的方式单独管理 SDK 所需资源文件。</p><h4><a name="header-n504" class="md-header-anchor code-item"></a>配置接口</h4><p>集成用户需要使用iOS SDK 中提供的以下接口完成验证流程：</p><ol start=""><li>配置验证初始化；</li><li>启动验证；</li><li>获取验证凭证（token）；</li><li>验证凭证（需集成用户使用服务器端SDK后自行校验）</li></ol><p>配置说明：在用户集成SDK前，需要到VAPTCHA开发平台获取对应的vid和scene以初始化SDK配置。以及需要配置宕机模式的服务器，具体参考宕机服务器设置—&gt;<a href="#header-n0">宕机服务器连接</a></p><h4><a name="header-n505" class="md-header-anchor code-item"></a>代码示例</h4><h5><a name="header-n75" class="md-header-anchor "></a>1. 嵌入式</h5><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>&#8203;</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//获取管理类</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- (VPEmbedManager *)embedManager {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  if (!_embedManager) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  _embedManager = [VPEmbedManager new];</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  _embedManager.delegate = self;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  return _embedManager;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//添加视图到图层</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[self.contentView addSubview:self.embedManager.embedView];</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  CGFloat width = defaultSize.width;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  CGFloat percentage = [VPEmbedManager embedViewWidthHeightPercentage];</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  [self.embedManager.embedView mas_makeConstraints:^(MASConstraintMaker *make) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  make.top.mas_equalTo(self.passwordView.mas_bottom).offset(padding);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  make.centerX.mas_equalTo(self.contentView);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  make.width.mas_equalTo(width);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; make.height.mas_equalTo(self.embedManager.embedView.mas_width).multipliedBy(1/percentage);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }];</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 448px;"></div><div class="CodeMirror-gutters" style="display: none; height: 448px;"></div></div></div></pre><p>使用<code>VPEmbedManager</code>获取嵌入视图，添加到集成用户的图层上。下图为demo样式：</p><p><img src="https://static.vaptcha.com/assets/img/document-ios4.png" alt="" referrerpolicy="no-referrer"></p><p>&nbsp;</p><h5><a name="header-n83" class="md-header-anchor "></a>2. 点击式</h5><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> //获取管理类</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- (VPClickManager *)clickManager {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  if (!_clickManager) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  _clickManager = [VPClickManager new];</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  _clickManager.delegate = self;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  return _clickManager;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">&#8203;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//添加到图层</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[self.view addSubview:self.clickManager.clickButton];</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  [self.clickManager.clickButton mas_makeConstraints:^(MASConstraintMaker *make) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  make.top.mas_equalTo(self.clickFour.mas_bottom).offset(padding);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  make.centerX.mas_equalTo(self.contentView);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  make.size.mas_equalTo(defaultSize);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }];</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 360px;"></div><div class="CodeMirror-gutters" style="display: none; height: 360px;"></div></div></div></pre><p>使用<code>VPClickManager</code>获取点击按钮视图，添加到集成用户的图层上。下图为demo样式：</p><p><img src="https://static.vaptcha.com/assets/img/document-ios5.png" alt="" referrerpolicy="no-referrer"></p><p>&nbsp;</p><h5><a name="header-n91" class="md-header-anchor "></a>3. 隐藏式</h5><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//获取管理类</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">- (VPInvisibleManager *)manager {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  if (!_manager) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  _manager = [[VPInvisibleManager alloc] init];</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  _manager.delegate = self;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  return _manager;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//开始隐藏式验证</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[self.manager startInsivible];</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 228px;"></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></pre><p>使用<code>VPInvisibleManager</code>管理类开始隐藏式验证。下图为demo样式：</p><p>&nbsp;</p><p><img src="https://static.vaptcha.com/assets/img/document-ios6.png" alt="参数说明" referrerpolicy="no-referrer"></p><p>&nbsp;</p><p>以上为VAPTCHA SDK提供的三种验证方式，具体更多参数设置详见 <a href="https://github.com/VAPTCHA/VAPTCHA-iOS">Demo</a>。</p><p>备注：该SDK目前暂不支持bitcode。</p></div><p>&nbsp;</p><div id="write" class="is-node"><h1><a name="header-n600" class="md-header-anchor code-item"></a>VAPTCHA-Android SDK部署</h1><blockquote><p>行为验证 Android SDK提供给集成Android原生客户端开发的开发者使用, SDK不依赖任何第三方库。</p></blockquote><h4><a name="header-n601" class="md-header-anchor code-item"></a>环境需求</h4><figure><table><thead><tr><th>条目</th><th>资源</th></tr></thead><tbody><tr><td>开发目标</td><td>API 18+</td></tr><tr><td>开发环境</td><td>android studio</td></tr><tr><td>demo依赖</td><td>okgo</td></tr></tbody></table></figure><h4><a name="header-n602" class="md-header-anchor code-item"></a>资源下载</h4><figure><table><thead><tr><th>条目</th><th>资源地址</th></tr></thead><tbody><tr><td>jar下载</td><td><a href="https://github.com/VAPTCHA/vaptcha_android_libary">vaptcha_android_libary</a></td></tr><tr><td>Demo工程下载</td><td><a href="https://github.com/VAPTCHA/VAPTCHA-android">vaptcha_android</a></td></tr></tbody></table></figure><h4><a name="header-n603" class="md-header-anchor code-item"></a>配置</h4><h5><a name="header-n31" class="md-header-anchor "></a>1.获取JAR包</h5><p>通过git命令获取：</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//Step 1. Add the JitPack repository to your build file</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  maven { url 'https://www.jitpack.io' }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//Step 2. Add the dependency</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> implementation 'com.github.VAPTCHA:vaptcha_android_libary:Tag'</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 96px;"></div></div></div></pre><p>手动下载JAR包：<a href="https://github.com/VAPTCHA/vaptcha_android_libary/tree/1.0.0">Github: vaptcha android</a></p><h5><a name="header-n38" class="md-header-anchor "></a>2.studio导入</h5><p><a name="header-n39" class="md-header-anchor "></a>模式分类</p><figure><table><thead><tr><th>模式</th><th>type</th><th>描述</th></tr></thead><tbody><tr><td>嵌入式</td><td>embed</td><td>自定义验证视图 在xml中直接引入</td></tr><tr><td>点击式</td><td>popup</td><td>自定义按钮 在xml中直接引</td></tr><tr><td>隐藏式</td><td>invisible</td><td>定义了java方法 在用户需要的地方直接调用</td></tr></tbody></table></figure><h4><a name="header-n57" class="md-header-anchor "></a>manifest中加入加入权限：</h4><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//网络权限</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&lt;uses-permission android:name="android.permission.INTERNET"/&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//获取当前网络状态</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/&gt;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 96px;"></div></div></div></pre><h4><a name="header-n604" class="md-header-anchor code-item"></a>代码示例</h4><h5><a name="header-n60" class="md-header-anchor "></a>1. 嵌入式</h5><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//在xml中直接引用并配置</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &lt;com.vaptcha.VaptchaView</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  android:layout_width="wrap_content"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  android:layout_height="wrap_content"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  app:vaptcha_scene="01"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  app:vaptcha_type="embed"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  app:vaptcha_vid="5af01666a485d42f244c7d0d"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  /&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//初始化 并设置监听</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  VaptchaView  vaptchaView = findViewById(R.id.vaptchaView);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  vaptchaView.setVaptchaListener(new vaptchaListener() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  public void onError() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  //验证失败</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  public void onExection() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  //验证异常</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  public void onSuccess(String token) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  //验证成功 拿到token</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  tv_login.setEnabled(true);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  });</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  //验证重置</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; vaptchaView.vaptchaReset();</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 602px;"></div><div class="CodeMirror-gutters" style="display: none; height: 602px;"></div></div></div></pre><p>参数说明</p><figure><table><thead><tr><th>参数名</th><th>描述</th><th>&nbsp;</th></tr></thead><tbody><tr><td>vaptcha_type</td><td>embed（嵌入式）</td><td>必填</td></tr><tr><td>vaptcha_vid</td><td>vaptcha获取到的vid</td><td>必填</td></tr><tr><td>vaptcha_scene</td><td>描述</td><td>必填</td></tr><tr><td>vaptcha_isOutAge</td><td>true进入宕机模式</td><td>选填</td></tr><tr><td>vaptcha_outage_url</td><td>宕机模式的服务器地址</td><td>选填</td></tr><tr><td>vaptcha_lang</td><td>语言（简体中文 zh-Hans）（繁体中文 zh-Hant）（英文 en）</td><td>选填</td></tr></tbody></table></figure><p>效果图</p><p><img src="https://upload-images.jianshu.io/upload_images/5439590-9161289dac3b1b02.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="嵌入式     效果图" referrerpolicy="no-referrer"></p><h5><a name="header-n96" class="md-header-anchor "></a>2.点击式</h5><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  &lt;com.vaptcha.VaptchaView</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  android:id="@@+id/vaptchaButton"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  android:layout_width="match_parent"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  android:layout_height="wrap_content"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  app:vaptcha_color="#cccccc"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  app:vaptcha_scene="01"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  app:vaptcha_type="popup"</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  app:vaptcha_vid="5af01666a485d42f244c7d0d" /&gt;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">//初始化 并设置监听</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; vaptchaButton=mView.findViewById(R.id.vaptchaButton);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; vaptchaButton.setVaptchaListener(new vaptchaListener() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  public void onError() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  //验证失败</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  public void onExection() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  //验证异常</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  public void onSuccess(String token) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  // 验证成功 拿到token</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  });</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  //验证重置</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  vaptchaButton.vaptchaReset();</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 580px;"></div><div class="CodeMirror-gutters" style="display: none; height: 580px;"></div></div></div></pre><p>参数说明</p><figure><table><thead><tr><th>参数名</th><th>描述</th><th>&nbsp;</th></tr></thead><tbody><tr><td>vaptcha_type</td><td>popup（点击式）</td><td>必填</td></tr><tr><td>vaptcha_vid</td><td>vaptcha获取到的vid</td><td>必填</td></tr><tr><td>vaptcha_scene</td><td>描述</td><td>必填</td></tr><tr><td>vaptcha_isOutAge</td><td>true进入宕机模式</td><td>选填</td></tr><tr><td>vaptcha_outage_url</td><td>宕机模式的服务器地址</td><td>选填</td></tr><tr><td>vaptcha_color</td><td>按钮颜色</td><td>选填</td></tr><tr><td>vaptcha_lang</td><td>语言（简体中文 zh-Hans）（繁体中文 zh-Hant）（英文 en）</td><td>选填</td></tr></tbody></table></figure><p>效果图</p><p><img src="https://upload-images.jianshu.io/upload_images/5439590-7cfce4e493b722e4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="点击式 效果图" referrerpolicy="no-referrer"></p><h5><a name="header-n137" class="md-header-anchor "></a>3.隐藏式</h5><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  //初始化VaptchaView &nbsp; 并传入配置参数</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; VaptchaView  hide_view =new VaptchaView(getContext(), "invisible", "5af01666a485d42f244c7d0d", "01");</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  //调起验证界面</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  hide_view.show();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  //添加验证监听</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  hide_view.setVaptchaListener( new vaptchaListener() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  public void onError() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  //验证错误</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  public void onExection() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  //验证异常</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  @@Override</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  public void onSuccess(String token) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  //验证成功</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  };);</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 448px;"></div><div class="CodeMirror-gutters" style="display: none; height: 448px;"></div></div></div></pre><p>参数说明</p><figure><table><thead><tr><th>参数名</th><th>描述</th><th>&nbsp;</th></tr></thead><tbody><tr><td>Context</td><td>上下文</td><td>必填</td></tr><tr><td>vaptcha_type</td><td>invisible</td><td>必填</td></tr><tr><td>vaptcha_vid</td><td>vaptcha获取到的vid</td><td>必填</td></tr><tr><td>vaptcha_scene</td><td>描述</td><td>必填</td></tr><tr><td>vaptcha_isOutAge</td><td>true进入宕机模式</td><td>选填</td></tr><tr><td>vaptcha_outage_url</td><td>宕机模式的服务器地址</td><td>选填</td></tr><tr><td>vaptcha_lang</td><td>语言（简体中文 zh-Hans）（繁体中文 zh-Hant）（英文 en）</td><td>选填</td></tr></tbody></table></figure><p>效果图</p><p><img src="https://upload-images.jianshu.io/upload_images/5439590-64c7b605de715aca.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="隐藏式 效果图" referrerpolicy="no-referrer"></p><p>以上为VAPTCHA SDK提供的三种验证方式，具体更多参数设置详见 <a href="https://github.com/VAPTCHA/VAPTCHA-android">Demo</a>。</p><p>&nbsp;</p><p>&nbsp;</p></div><h1><a name='header-n221' class='md-header-anchor code-item'></a>服务端二次验证</h1><blockquote><p>服务端验证的接口与返回结果说明</p></blockquote><h4><a name='header-n225' class='md-header-anchor code-item'></a>API请求数据</h4><p>地址: <a href='http://api.vaptcha.com/v2/validate' target='_blank' class='url'>http://api.vaptcha.com/v2/validate</a></p><figure><table><thead><tr><th style='text-align:left;' >POST参数</th><th style='text-align:left;' >说明</th></tr></thead><tbody><tr><td style='text-align:left;' >id</td><td style='text-align:left;' >验证单元的<code>VID</code>(必填)</td></tr><tr><td style='text-align:left;' >secretkey</td><td style='text-align:left;' >验证单元的<code>Key</code>(必填)</td></tr><tr><td style='text-align:left;' >scene</td><td style='text-align:left;' >验证单元场景，需与前端配置参数中的scene一致，e.g: <code>&#39;01&#39;</code></td></tr><tr><td style='text-align:left;' >token</td><td style='text-align:left;' >客户端验证成功得到的<code>token</code>(必填)</td></tr><tr><td style='text-align:left;' >ip</td><td style='text-align:left;' >获取用户的<code>remote address</code></td></tr></tbody></table></figure><h4><a name='header-n247' class='md-header-anchor code-item'></a>API响应结果</h4><p>返回<code>json</code>字符串</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="json"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"success"</span>: <span class="cm-number">1</span>, <span class="cm-comment">//验证结果，1为通过，0为失败</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"score"</span>: <span class="cm-number">90</span>, <span class="cm-comment">//可信度，区间[0, 100]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"msg"</span>: <span class="cm-string">""</span> <span class="cm-comment">//错误信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 118px;"></div><div class="CodeMirror-gutters" style="display: none; height: 118px;"></div></div></div></pre><p><strong>错误消息说明</strong></p><figure><table><thead><tr><th style='text-align:left;' >错误消息</th><th style='text-align:left;' >说明</th></tr></thead><tbody><tr><td style='text-align:left;' >id-empty</td><td style='text-align:left;' ><code>id</code>为空</td></tr><tr><td style='text-align:left;' >id-error</td><td style='text-align:left;' ><code>id</code>错误</td></tr><tr><td style='text-align:left;' >scene-error</td><td style='text-align:left;' >场景号错误</td></tr><tr><td style='text-align:left;' >token-error</td><td style='text-align:left;' ><code>token</code>错误</td></tr><tr><td style='text-align:left;' >token-expired</td><td style='text-align:left;' ><code>token</code>过期，<code>token</code>三分钟有效期</td></tr><tr><td style='text-align:left;' >over-user-limit</td><td style='text-align:left;' >超过VIP用户自定义的频率上限</td></tr><tr><td style='text-align:left;' >bad-request</td><td style='text-align:left;' >请求错误</td></tr></tbody></table></figure><p>&nbsp;</p><h1><a name="header-n0" class="md-header-anchor "></a>宕机模式（服务端配置）</h1><blockquote><p>此文档的示例代码使用<code>Nodejs</code>，仅供参考，部分方法需用户自己实现，具体实现可根据实际情况作调整。宕机模式为可选配置项，请根据需要自行配置。（<a target="_blank" href="https://www.vaptcha.com/document/faq#%E5%AE%95%E6%9C%BA%E6%A8%A1%E5%BC%8F">宕机模式原理</a>）</p></blockquote><h2><a name="header-n8" class="md-header-anchor code-item"></a>outage接口说明</h2><p>用户服务器端应增加 <code>outage</code> 接口，此接口为<code>jsonp</code>类型， 接口地址以参数的形式传入前端验证码初始化函数中，进入宕机模式后由sdk调用。</p><p>前端初始化示例代码: </p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">vaptcha</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">vid</span>: <span class="cm-string">'****'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">container</span>: <span class="cm-string">'#vaptcha-container'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">outage</span>: <span class="cm-string">'/outage'</span>, <span class="cm-comment">// 你服务端提供的接口地址，包含获取图片和验证轨迹两种操作</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">mode</span>: <span class="cm-string">'downtime'</span> <span class="cm-comment">// 加入此参数直接进入宕机模式，用于调试，上线请删除</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}).<span class="cm-property">then</span>(<span class="cm-keyword">function</span>(<span class="cm-def">obj</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable-2">obj</span>.<span class="cm-property">render</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><h2><a name="header-n16" class="md-header-anchor code-item"></a>接口参数</h2><h3><a name="header-n17" class="md-header-anchor "></a>接受参数</h3><figure><table><thead><tr><th>参数名</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>callback</td><td><code>string</code></td><td>jsonp回调函数名</td></tr><tr><td>action</td><td><code>string</code></td><td>值为<code>get</code>获取验证图片，值为<code>verify</code>进行人机验证。</td></tr><tr><td>v</td><td><code>string</code></td><td>轨迹参数</td></tr><tr><td>challenge</td><td><code>string</code></td><td>流水号</td></tr></tbody></table></figure><h2><a name="header-n41" class="md-header-anchor code-item"></a>get 获取图片操作</h2><blockquote><p><code>outage</code>接口的<code>action</code>值 为 <code>get</code>时的操作</p></blockquote><p>获取流程：</p><ol start=""><li><p>获取服务器宕机<code>key</code></p><p>请求 <a href="http://d.vaptcha.com/config" target="_blank" class="url">http://d.vaptcha.com/config</a> ，此接口返回<code>json</code>数据，格式</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="json"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"key"</span>:<span class="cm-string">"*************"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"active"</span>: <span class="cm-atom">false</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 96px;"></div></div></div></pre><p>其中<code>key</code>即为宕机<code>key</code>，示例代码:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// getJson 方法需自行实现，获取接口的Json数据</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">result</span> <span class="cm-operator">=</span> <span class="cm-variable">getJson</span>(<span class="cm-string">'http://d.vaptcha.com/config'</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">downtimeKey</span> <span class="cm-operator">=</span> <span class="cm-variable">result</span>.<span class="cm-property">key</span>;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="display: none; height: 74px;"></div></div></div></pre><p><code>active</code>表示是否进入宕机，<code>true</code>表示进入宕机。</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">result</span>.<span class="cm-property">active</span>) {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// vaptcha并未宕机，返回失败</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 调试时需跳过此判断</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 96px;"></div></div></div></pre></li><li><p>生成随机数<code>randomStr</code></p><p>从“0123456789abcdef”中取4位16进制数的字符串<code>randomStr</code>，示例代码:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">getRandomStr</span> <span class="cm-operator">=</span> () <span class="cm-operator">=&gt;</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">const</span> <span class="cm-def">str</span> <span class="cm-operator">=</span> <span class="cm-string">'0123456789abcdef'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">Array</span>(<span class="cm-number">4</span>).<span class="cm-property">fill</span>(<span class="cm-number">0</span>).<span class="cm-property">map</span>(<span class="cm-def">v</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable-2">str</span>[<span class="cm-variable">Math</span>.<span class="cm-property">floor</span>(<span class="cm-variable">Math</span>.<span class="cm-property">random</span>() <span class="cm-operator">*</span> <span class="cm-number">16</span>)]).<span class="cm-property">join</span>(<span class="cm-string">''</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">randomStr</span> <span class="cm-operator">=</span> <span class="cm-variable">getRandomStr</span>();</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 118px;"></div><div class="CodeMirror-gutters" style="display: none; height: 118px;"></div></div></div></pre></li><li><p>生成验证图<code>imgid</code></p><p>取宕机<code>key</code>和<code>randomStr</code>的<code>md5</code>值作为验证图的<code>imgid</code>，示例代码:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">imgid</span> <span class="cm-operator">=</span> <span class="cm-variable">md5</span>(<span class="cm-variable">key</span> <span class="cm-operator">+</span> <span class="cm-variable">radomStr</span>);</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 30px;"></div><div class="CodeMirror-gutters" style="display: none; height: 30px;"></div></div></div></pre></li><li><p>生成流水号<code>challenge</code></p><p>服务器端生成唯一字符串<code>challenge</code>，用于标识本次验证操作，如：GUID ，自增数等，官方的示例操作是将字符串作为键，<code>imgid</code>作为值存入<code>session</code>中，示例代码</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">challenge</span> <span class="cm-operator">=</span> <span class="cm-variable">uniqueId</span>();</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">setSession</span>(<span class="cm-variable">challenge</span>, <span class="cm-variable">imgid</span>, <span class="cm-number">3</span> <span class="cm-operator">*</span> <span class="cm-number">60</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span>); <span class="cm-comment">// challenge 3分钟有效期</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><p>同一次验证多次请求图片，所以会带上上一次的<code>challenge</code>，<code>get</code>接口接受到参数<code>challenge</code>后，不用再次生成<code>challenge</code>，只需重新生成<code>imgid</code>。示例代码：</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">let</span> <span class="cm-def">challenge</span> <span class="cm-operator">=</span> <span class="cm-variable">getRequest</span>(<span class="cm-string">'challenge'</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-variable">isEmpty</span>(<span class="cm-variable">challenge</span>)) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">challenge</span> <span class="cm-operator">=</span> <span class="cm-variable">uniqueId</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">setSession</span>(<span class="cm-variable">challenge</span>, <span class="cm-variable">imgid</span>, <span class="cm-number">3</span> <span class="cm-operator">*</span> <span class="cm-number">60</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span>); <span class="cm-comment">// challenge 3分钟有效期</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 118px;"></div><div class="CodeMirror-gutters" style="display: none; height: 118px;"></div></div></div></pre></li><li><p>返回<code>jsonp</code>格式数据，<code>code</code>为返回码，<code>0103</code>表示获取成功，<code>0104</code>表示获取失败。</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">callback</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">code</span>: <span class="cm-string">'0103'</span><span class="cm-variable">，</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">imgid</span>: <span class="cm-variable">imageid</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">challenge：challenge</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 118px;"></div><div class="CodeMirror-gutters" style="display: none; height: 118px;"></div></div></div></pre></li></ol><h2><a name="header-n85" class="md-header-anchor code-item"></a>verify 轨迹验证操作</h2><blockquote><p><code>outage</code>接口的<code>action</code>值 为 <code>verify</code>时的操作</p></blockquote><p>用户在浏览器上完成人机验证后，前端sdk向outage接口发起验证请求。</p><p>验证流程：</p><ol start=""><li><p>生成轨迹验证<code>validatekey</code></p><p>首先通过请求参数<code>challenge</code>获取<code>session</code>中缓存的<code>imgid</code>，再取请求参数<code>v</code>和<code>imgid</code>的<code>md5</code>值作为用于验证的<code>validatekey</code>，示例代码：</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">challenge</span> <span class="cm-operator">=</span> <span class="cm-variable">getRequest</span>(<span class="cm-string">'challenge'</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">v</span> <span class="cm-operator">=</span> <span class="cm-variable">getRequest</span>(<span class="cm-string">'v'</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">imgid</span> <span class="cm-operator">=</span> <span class="cm-variable">getSession</span>(<span class="cm-variable">challenge</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">validatekey</span> <span class="cm-operator">=</span> <span class="cm-variable">md5</span>(<span class="cm-variable">imgid</span> <span class="cm-operator">+</span> <span class="cm-variable">v</span>);</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 96px;"></div></div></div></pre></li><li><p>服务器端发起轨迹验证请求</p><p>请求地址 <a href="http://d.vaptcha.com/" target="_blank" class="url">http://d.vaptcha.com/</a>，接口返回<code>json</code>数据，示例代码：</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">result</span> <span class="cm-operator">=</span> <span class="cm-variable">getJson</span>(<span class="cm-string">'http://d.vaptcha.com/'</span> <span class="cm-operator">+</span> <span class="cm-variable">validatekey</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-variable">result</span>.<span class="cm-property">code</span> <span class="cm-operator">===</span> <span class="cm-number">200</span>) { <span class="cm-comment">/*验证成功，返回token*/</span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">else</span> {<span class="cm-comment">/*验证错误*/</span>}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="display: none; height: 74px;"></div></div></div></pre></li><li><p>验证成功，返回<code>token</code></p><p>验证成功后生成一个唯一的<code>token</code>，存在服务端用于提交表单的验证，并将<code>token</code>返回，同时清除<code>chalenge</code>的<code>session</code>信息，示例代码：</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clearSession</span>(<span class="cm-variable">challenge</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">token</span> <span class="cm-operator">=</span> <span class="cm-variable">uniqueId</span>();</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">setSession</span>(<span class="cm-string">'token'</span>, <span class="cm-variable">token</span>, <span class="cm-number">3</span> <span class="cm-operator">*</span> <span class="cm-number">60</span> <span class="cm-operator">*</span> <span class="cm-number">1000</span>); <span class="cm-comment">// token 3分钟有效期</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 74px;"></div><div class="CodeMirror-gutters" style="display: none; height: 74px;"></div></div></div></pre></li><li><p>返回验证结果，返回 <code>jsonp</code> 格式数据，正确返回:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">callback</span>({</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">code</span>:<span class="cm-string">'0103'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-property">token</span>:<span class="cm-variable">validatetoken</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 96px;"></div></div></div></pre></li></ol><h2><a name="header-n117" class="md-header-anchor code-item"></a>服务器端验证token</h2><p>前端完成验证提交表单数据时，将 <code>token</code> 一并提交，服务器端验证通过 <code>token</code> 内容判断用户验证操作是否有效，<code>token</code>只可验证一次，验证通过后应清除<code>token</code>。示例代码:</p><pre spellcheck="false" class="md-fences md-end-block contain-cm modeLoaded" lang="javascript"><div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 12px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">const</span> <span class="cm-def">token</span> <span class="cm-operator">=</span> <span class="cm-variable">getRequest</span>(<span class="cm-string">'token'</span>);</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> (<span class="cm-variable">getSession</span>(<span class="cm-string">'token'</span>)) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">clearSession</span>(<span class="cm-string">'token'</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-comment">/*pass*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">} <span class="cm-keyword">else</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-comment">/*fail*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 162px;"></div><div class="CodeMirror-gutters" style="display: none; height: 162px;"></div></div></div></pre><h2><a name="header-n121" class="md-header-anchor code-item"></a>完整demo</h2><p>地址: <a target="_blank" href="https://github.com/VAPTCHA/vaptcha-donwtime">https://github.com/VAPTCHA/vaptcha-donwtime</a></p></div>
                        </div>
                </div>
           </div>
        </div>
    </div>
    <script>
         $(document).ready(function(){
            var config = {
                vx: 4,
                vy: 4,
                height: 2,
                width: 2,
                count: 60,
                color: "34,79,151",
                stroke: "173,203,251",
                dist: 6000,
                e_dist: 20000,
                max_conn: 10
            }
            CanvasParticle(config);
            var switchServer = function(text){
                var _class = '#'+text;
                $(_class).siblings().removeClass('active');
                $(_class).addClass('active');
            }
            $('.main-left-one').children().on('click',function(){
                setTimeout(() => {
                    $('.main-left-one li a').removeClass('current')
                    $(this).children().addClass('current');
                    var text = $(this).children().attr("name");
                    switchServer(text);
                    var childrens = $('.service').children()
                    for(var i=0,len=childrens.length;i<len;i++){
                        if($(childrens[i]).attr("name")===text){
                            $(childrens[i]).siblings().removeClass('active');
                            $(childrens[i]).addClass('active');
                            return ;
                        }
                    }
                }, 20);
            })
            //点击两个主标签栏，对应选中第一个子元素
            $("#smsweb").click(function(){
                setTimeout(function(){
                    $(".main-left-one li a").removeClass('current');
                    $(".main-left-one.smsweb li a:first").addClass('current');
                },20)
            })
            $("#verification").click(function(){
                setTimeout(function(){
                    $(".main-left-one li a").removeClass('current');
                    $(".main-left-one.smsweb li a:first").addClass('current');
                },20)
            })
            $("#smsonce").click(function(){
                setTimeout(function(){
                    $(".main-left-one li a").removeClass('current');
                    $(".main-left-one.smsonce li a:first").addClass('current');
                },20)
             })
             $("#downtime").click(function(){
                setTimeout(function(){
                    $(".main-left-one li a").removeClass('current');
                    $(".main-left-one.downtime li a:first").addClass('current');
                },20)
             })
             $("#android").click(function(){
                setTimeout(function(){
                    $(".main-left-one li a").removeClass('current');
                    $(".main-left-one.android li a:first").addClass('current');
                },20)
             })
             $("#ios").click(function(){
                setTimeout(function(){
                    $(".main-left-one li a").removeClass('current');
                    $(".main-left-one.ios li a:first").addClass('current');
                },20)
             })
             function scroll(val){
                var items = $(".main-cont .main-right").find(".code-item");
                var menu = $(".main-cont .main-left ul");
                var card = $(".main-cont .main-left");
                var currentId = "";
                items.each(function() {
                    var m = $(this);
                    if(0 > m.offset().top - 220){
                        if( m.attr("name")){
                            currentId = "#" + m.attr("name");
                            var currentLink = menu.find(".current");
                            if (menu.find("[href=" + currentId + "]").length !== 0 && currentLink.attr("href") != currentId) {      
                                currentLink.removeClass("current");
                                menu.find("[href=" + currentId + "]").addClass("current");
                            }
                            // else if(currentId === '#header-n221'){
                            //     //特殊处理，当滑动到第二个大选项卡，选择下面的选项卡，其余选择上面的选项卡
                            //     //#header-n919 #header-n924
                            //     currentLink.removeClass("current");
                            //     menu.find("[href='#header-n225']").addClass("current");
                            // }
                            // else if(currentId === '#header-n0'){
                            //     currentLink.removeClass("current");
                            //     menu.find("[href='#header-n8']").addClass("current");
                            // }
                        }
                    }
                });
                if(val){
                    var link = window.location.href;
                    if(link.indexOf('header-n0') !== -1){
                        $(".main-left-cont .main-left .main-left-one a").removeClass('current');
                        menu.find("[href='#header-n8']").addClass("current");
                        var buy = document.getElementById('downtime');
                        buy.click();
                    }
                    if(link.indexOf('header-n221') !== -1){
                        $(".main-left-cont .main-left .main-left-one a").removeClass('current');
                        menu.find("[href='#header-n225']").addClass("current");
                        var buy = document.getElementById('smsonce');
                        buy.click();
                    }
                }
             }
            $(".main-cont .main-right").scroll(function() {
                if(once){
                    scroll(1);
                    once = 0;
                }else{
                    scroll(0);
                }
                var top = $(".main-cont .main-right .con").offset().top;
                var main = $(".main-cont").css("top");
                if ( top > 0 ) {
                    if($(".main-cont").css("top") == "50px"){
                        $(".main-cont").animate({"top":"240px"},200);
                        $(".vaptcha .nav").animate({"margin-top":0},200);
                    }
                 }else{
                    if($(".main-cont").css("top") == "240px"){
                        $(".main-cont").animate({"top":"50px"},200);
                        $(".vaptcha .nav").animate({"margin-top":"-189px"},200);
                    }
                }
            });
            let once = 1;
            scroll(1);
        })
    </script>
</body>

</html>
